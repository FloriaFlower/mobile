# 图片设置弹窗设计方案

## UI结构设计

### 弹窗整体布局
```
┌─────────────────────────────────────┐
│ 图片设置                    ✕       │ ← 标题栏（紧凑）
├─────────────────────────────────────┤
│ [用户头像] [消息背景]               │ ← 标签页（紧凑）
├─────────────────────────────────────┤
│ ┌─────────────┐ 上传图片 [选择文件] │ ← 上传区域（紧凑）
│ │   预览区域   │ 图片链接 [_______] │
│ │  (圆形/方形) │                    │
│ └─────────────┘                    │
│ 位置调整: ↕️ ↔️  旋转: [___] 缩放:[_] │ ← 控制区域（紧凑）
│                           [保存]    │ ← 操作按钮（紧凑）
└─────────────────────────────────────┘
```

### 响应式断点
- 宽屏 (>480px): 横向布局，预览区域较大
- 中屏 (360-480px): 紧凑布局，预览区域中等
- 小屏 (<360px): 垂直布局，预览区域较小

### 关键特性
1. **紧凑布局**: 最小化间距，确保内容可见
2. **实时预览**: 圆形头像预览、长方形背景预览
3. **拖拽调整**: 支持鼠标和触摸拖拽调整位置
4. **配置保存**: 集成现有的StyleConfigManager保存逻辑
5. **状态恢复**: 下次打开时恢复之前的设置

## 技术实现要点

### 1. 弹窗定位
- 使用手机容器作为定位基准
- 固定定位，覆盖整个手机屏幕
- z-index确保在最顶层

### 2. 图片预览
- 背景预览：长方形容器，aspect-ratio: 16/9
- 头像预览：圆形容器，1:1比例
- 实时更新：拖拽时实时显示效果

### 3. 拖拽实现
- 监听mousedown/touchstart事件
- 计算拖拽偏移量
- 转换为CSS background-position
- 实时更新预览效果

### 4. 配置集成
- 复用StyleConfigManager的保存逻辑
- 支持Data Bank和localStorage双重保存
- 配置格式与现有系统兼容

## CSS设计原则

### 1. 紧凑布局
```css
.image-config-modal {
  padding: 8px;  /* 最小化padding */
  gap: 6px;      /* 最小化组件间距 */
}

.config-row {
  margin-bottom: 4px;  /* 最小化行间距 */
}
```

### 2. 响应式设计
```css
@media (max-width: 480px) {
  .preview-container { width: 120px; height: 80px; }
  .control-input { font-size: 12px; padding: 2px 4px; }
}

@media (max-width: 360px) {
  .preview-container { width: 100px; height: 60px; }
  .control-input { font-size: 11px; padding: 1px 3px; }
}
```

### 3. QQ风格适配
- 使用现有的颜色变量
- 保持与消息应用一致的视觉风格
- 圆角、阴影等细节与现有UI匹配

## 功能模块

### 1. 图片上传模块
- 文件选择器
- 拖拽上传支持
- URL输入框
- 格式验证

### 2. 预览模块
- 实时预览更新
- 拖拽位置调整
- 旋转缩放控制
- 效果同步显示

### 3. 配置保存模块
- 集成StyleConfigManager
- 保存到Data Bank
- localStorage备份
- 错误处理

### 4. 交互控制模块
- 标签页切换
- 事件绑定管理
- 弹窗显示/隐藏
- 状态恢复
